#include <stdlib.h>
#include <stdio.h>
#include "../includes/ft_printf.h"
#include <limits.h>
#include <math.h>
#include <fcntl.h>
#include <string.h>
#include <limits.h>
#include <stdint.h>

/*int main(void)
{
	long_nbr_t a;
	long_nbr_t b;
	long_nbr_t res;
	a.nbr = malloc(1500 * sizeof(long long));
	b.nbr = malloc(1500 * sizeof(long long));
	int j = 0;
	while (j < 1500)
		a.nbr[j++] = 9;
	j = 0;
	while (j < 1500)
		b.nbr[j++] = 9;
	a.size = 1500;
	b.size = 1500;
	res = karatsuba(a, b);
	int i = res.size - 1;
	while (i >= 0)
		printf("%lld", res.nbr[i--]);
	return (0);
}
*/

/*void	print_nbr(long_nbr_t a)
{
	int i = a.size - 1;
	while (i >= 0)
		printf("%lld", a.nbr[i--]);
	printf("|||%lld|||\n", a.size);
}

int new = 0;

void		pass_zero(long_nbr_t *a)
{
	int i;

	i = (*a).size - 1;
	while (i >= 0 && (*a).nbr[i--] == 0)
		(*a).size--;
}

void	normalize(long_nbr_t *l)
{
	long long i;
	long long tmp;

	i = 0;
	while (i < ((*l).size - 1)) 
	{
		if ((*l).nbr[i] >= 10)
		{
			tmp = (*l).nbr[i] / 10;
			(*l).nbr[i + 1] += tmp;
			(*l).nbr[i] -= tmp * 10;
		}
		else if ((*l).nbr[i] < 0)
		{
			tmp = (((*l).nbr[i] + 1) / 10) - 1;
			(*l).nbr[i + 1] += tmp;
			(*l).nbr[i] -= tmp * 10;
		}
		++i;
	}
}

long_nbr_t	sum(long_nbr_t a, long_nbr_t b)
{
	long_nbr_t sum;
	int i;

	sum.size = a.size;
	sum.nbr = (long long *)malloc(sizeof(long long) * sum.size);
	ft_bzero(sum.nbr, sizeof(long long) * sum.size);
	printf("first operand\n");
	print_nbr(a);
	printf("second operand\n");
	print_nbr(b);
	if (a.size > b.size)
	{
		sum.size = a.size;
		sum.nbr = (long long *)malloc(sizeof(long long) * sum.size);
		i = -1;
		while (++i < a.size)
			sum.nbr[i] = a.nbr[i] + (i < b.size ? b.nbr[i] : 0);
	}
	else
	{
		sum.size = .size;
		sum.nbr = (long long *)malloc(sizeof(long long) * sum.size);
		i = -1;
		while (++i < b.size)
			sum.nbr[i] = b.nbr[i] + (i < a.size ? a.nbr[i] : 0);
	}
	normalize(&sum);
	return (sum);
}

void	restore_parity(long_nbr_t *nbr, int size)
{
	long long *new_nbr;
	int i;
	int j;
	int z;

	new_nbr = (long long *)malloc(sizeof(long long) * ((*nbr).size + size));
	ft_bzero(new_nbr, sizeof(long long) * ((*nbr).size + size));
	i = 0;
	j = size;
	while (j--)
		new_nbr[i++] = 0;
	z = (*nbr).size - 1;
	while (z >= 0 && (*nbr).nbr[z] == 0)
		z--;
	j = 0;
	while (j <= z)
		new_nbr[i++] = (*nbr).nbr[j++];
	//free((*nbr).nbr);
	(*nbr).nbr = new_nbr;
	(*nbr).size += size;
}

void		compensation(long_nbr_t *a, int zero)
{
	long long *new_nbr;
	int i;
	int j;
	int z;

	new_nbr = (long long *)malloc(sizeof(long long) * ((*a).size - zero ));
	i = 0;
	j = 0;
	z = zero;
	while (zero--)
		j++;
	while (j <= (*a).size - 1)
		new_nbr[i++] = (*a).nbr[j++];
	free((*a).nbr);
	(*a).nbr = new_nbr;
	(*a).size -= z;
}

long_nbr_t karatsuba(long_nbr_t a, long_nbr_t b)
{
	long_nbr_t res;
	int zero;
	int flag;
	
	flag = 0;
	res.size = a.size + b.size;
	res.nbr = (long long *)malloc(sizeof(long long) * res.size);
	ft_bzero(res.nbr, sizeof(long long) * res.size);
	if (a.size != b.size && a.size == 20)
	{ 
		if (a.size > b.size)
		{
			zero = a.size - b.size;
			restore_parity(&b, a.size - b.size);
		}
		else
		{
			zero = b.size - a.size;
			restore_parity(&a, b.size - a.size);
		}
	}
	if (a.size < 4 || b.size < 4)
		multi(a, b, &res);
	else
	{
		//printf("hello\n");
		long_nbr_t a_l;
		a_l.nbr = a.nbr;
		a_l.size = (a.size + 1) / 2;
	//	printf("a_l\n");
	//	print_nbr(a_l);
		long_nbr_t a_r;
		a_r.nbr = a.nbr + a_l.size;
		a_r.size = a.size / 2;
	//	printf("a_r\n");
	//	print_nbr(a_r);
		long_nbr_t b_l;
		b_l.nbr = b.nbr;
		b_l.size = (b.size + 1) / 2;
	//	printf("b_l\n");
	//	print_nbr(b_l);
		long_nbr_t b_r;
		b_r.nbr = b.nbr + b_l.size;
		b_r.size = b.size / 2;
	//	printf("b_r\n");
	//	print_nbr(b_r);
		long_nbr_t mul1 = karatsuba(a_r, b_r);
		printf("mul1\n");
		print_nbr(mul1);
		long_nbr_t mul2 = karatsuba(a_l, b_l);
		printf("mul2\n");
		print_nbr(mul2);
		long_nbr_t mul3 = karatsuba(sum(a_l, a_r), sum(b_l, b_r));
		printf("--------\n");
		printf("sum1\n");
		print_nbr(sum(a_l, a_r));
		printf("sum2\n");
		print_nbr(sum(b_l, b_r));
		printf("--------\n");
		printf("mul333before substraction\n");
		print_nbr(mul3);
		sub(sub(&mul3, mul1), mul2);
		normalize(&mul3);
		printf("mul333\n");
		print_nbr(mul3);
		if (a.size == 20)
		{
			restore_parity(&mul1, a.size);
			restore_parity(&mul3, a.size / 2);
		}
	//	printf("mul3\n");
	//	print_nbr(mul3);
	//	printf("mul2\n");
	//	print_nbr(mul2);
	//	printf("mul1\n");
	//	print_nbr(mul1);
		res = sum(mul1, mul3);
		printf("res after first sum\n");
		print_nbr(res);
		res = sum(res, mul2);
		printf("res after second sum\n");
		print_nbr(res);
		if (a.size == 20)
			compensation(&res, zero);
		printf("\nres:\n");
		print_nbr(res);
		free(mul1.nbr);
		free(mul2.nbr);
		free(mul3.nbr);
	}
	normalize(&res);
	return (res);
}*/

int main(int argc, char **argv)
{
	long double e;
	int test;
	//e = 0.97656257485178946517845148956174158741587412587412587415874120934857089237459278357823465237583475089237508972348057089234759834758L;
	//e = 0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001L;
	e = 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001L;
	//e = 0.0;
	test = ft_printf("{%.5000Lf}", e);
	printf("      >>>>>      bytes = %d\n", test);
	test = printf("{%.5000Lf}", e);
	printf("      >>>>>      bytes = %d\n", test);
	return (0);
}
